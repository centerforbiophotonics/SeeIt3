<!--
   accelTest.html
   
   Author: Matthew Steinwachs   
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"> 
	<meta name="viewport" content="user-scalable=no, width=device-width" />

	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0b2/jquery.mobile-1.0b2.min.css" />

	<script type="text/javascript" src = "http://code.jquery.com/jquery-1.6.2.min.js"></script>
	<script type="text/javascript" src = "http://code.jquery.com/mobile/1.0b2/jquery.mobile-1.0b2.min.js"></script>
 
	<script type="text/javascript">
		var xPos, yPos;
		var enterTime, exitTime;
		var inside = true;
		$(document).ready(function(){
			window.addEventListener("devicemotion",onDeviceMotion,false);
			xPos = window.innerWidth/2-10;
			yPos = window.innerHeight/2-10;
			enterTime = new Date().getTime();
			
			$('#target').css('top', window.innerHeight/2-20+"px")
									 .css('left',window.innerWidth/2-20+"px");
									 
			$('#pointer').css('top', yPos+"px")
									 .css('left',xPos+"px")
									 .css('z-index', 2);
		});
		
		
		
									 
		function onDeviceMotion(event){
			var accel = event.accelerationIncludingGravity;
			xPos += accel.x*20;
			if (xPos < 0) xPos = 0;
			if (xPos > window.innerWidth-20) xPos = window.innerWidth - 20;
			
			yPos -= accel.y*20;
			if (yPos < 0) yPos = 0;
			if (yPos > window.innerHeight-20) yPos = window.innerHeight - 20;
			
			if ((xPos < window.innerWidth/2-20 ||
					xPos+20 > window.innerWidth/2+20 ||
					yPos-10 < window.innerHeight/2-20 ||
					yPos+10 > window.innerHeight/2+20) &&
					inside){
				exitTime = new Date().getTime();
				inside = false;
				//$('#time').html("Your Time: "+ ((exitTime-enterTime) / 1000.0) + " Seconds");
				$('#target').css('background','#0000ff')
				alert("Your Time: "+ ((exitTime-enterTime) / 1000.0) + " Seconds");
			} 
			
			if ((xPos >= window.innerWidth/2-20 &&
					xPos+20 <= window.innerWidth/2+20 &&
					yPos-10 >= window.innerHeight/2-20 &&
					yPos+10 <= window.innerHeight/2+20) &&
					!inside ){
				enterTime = new Date().getTime();
				inside = true;
				$('#time').html("");
				$('#target').css('background','#00ff00');
			}
			
			$('#pointer').css('top', yPos+"px")
									 .css('left',xPos+"px");
									 
			
		}
	</script>
</head> 

<body>
	<h1 id="time"></h1>
	<div id="pointer" style="position: absolute; background: #ff0000; height:20px; width:20px;"></div>
	<div id="target" style="position: absolute; background: #00ff00;  height:40px; width:40px;"></div>
</body>

</html>
